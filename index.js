const { Client, LocalAuth } = require('whatsapp-web.js');
const qrcode = require('qrcode-terminal');
const { MessageMedia } = require('whatsapp-web.js');
const axios = require('axios');
const fs = require('fs');

const client = new Client({
    authStrategy: new LocalAuth(),
    puppeteer: {
        headless: true,
        args: ['--no-sandbox', '--disable-setuid-sandbox'],
    },
    webVersion: '2.2412.54', // Stable WhatsApp Web version
    webVersionCache: { type: 'local' }
});

// Store bot's own WhatsApp ID
let botId = null;

client.on('qr', (qr) => {
    qrcode.generate(qr, { small: true });
    console.log('üì± Scan the QR code above to log in.');
});

client.on('ready', () => {
    console.log('‚úÖ Bot is online and vibing! üî•');
    botId = client.info.wid._serialized;
    console.log(`Bot ID: ${botId}`);
});

// Function to send a random emoji reaction
async function sendRandomEmojiReaction(msg) {
    const emojis = [
        'üò∫', 'üöÄ', 'üåÆ', 'üëç', 'üî•', 'üòé',
        'ü¶Ñ', 'üß†', 'ü•∑', 'üõ∏', 'ü¶ñ', 'üóø', 'üåå',
        'üßÉ', 'üìü', 'üßø', 'üì°', 'üõ†Ô∏è', 'üîÆ', 'üïπÔ∏è',
        '‚öóÔ∏è', 'üõ∞Ô∏è', 'ü•Ω', 'ü™Ñ', 'üéõÔ∏è', 'üß¨', 'üß±'
    ];
    
    const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
    try {
        await msg.react(randomEmoji);
        console.log(`Reacted with ${randomEmoji} to message in group: ${msg.from}`);
    } catch (error) {
        console.error('Error sending reaction:', error.message);
    }
}

client.on('message', async (msg) => {
    const message = msg.body.toLowerCase().trim();
    const chatId = msg.from;
    const isGroup = chatId.endsWith('@g.us');
    const isBotMentioned = botId ? msg.mentionedIds.includes(botId) : false;

    // Debug: Log message context
    console.log(`üí¨ ${chatId}: ${msg.body} | Group: ${isGroup} | Mentioned: ${isBotMentioned} | HasQuotedMsg: ${msg.hasQuotedMsg}`);

    // Handle group messages
    if (isGroup && !isBotMentioned) {
        await sendRandomEmojiReaction(msg);
        return;
    }

    // === EXISTING COMMANDS ===
    try {
        if (message === 'hi' || message === 'hello') {
            await msg.reply(`
üëã *Welcome to vBot AI Deluxe*  
Type \`.menu\` to explore 100+ features!  
üöÄ Let's vibe with epic tools & tricks!
            `);
            return;
        }

        if (message === '.menu') {
            await msg.reply(`
üìã *Main Menu*  
Type the number or letter to choose a category:

1Ô∏è‚É£ Entertainment  
2Ô∏è‚É£ Productivity  
3Ô∏è‚É£ Developer Tools  
4Ô∏è‚É£ Quotes & Jokes  
5Ô∏è‚É£ AI & Fun  
6Ô∏è‚É£ Settings  
7Ô∏è‚É£ About  
8Ô∏è‚É£ Help  
9Ô∏è‚É£ Games  
üîü Utilities
            `);
            return;
        }

        // === MAIN CATEGORIES ===
        switch (message) {
            case '1':
                await msg.reply(`
üéÆ *Entertainment Zone*  
a. \`joke\` - Random joke  
b. \`meme\` - Random meme (via API)  
c. \`game\` - Surprise challenge  
d. \`quiz\` - Fun quiz  
e. \`riddle\` - Brain teaser  
f. \`trivia\` - Random trivia  
g. \`song\` - Song recommendation  
h. \`movie\` - Movie suggestion  
i. \`dance\` - Dance move generator  
j. \`story\` - Short story prompt  
k. \`emoji-story\` - Emoji-based story  
l. \`magic-trick\` - Virtual magic trick  
m. \`superhero\` - Create a superhero  
n. \`cartoon\` - Cartoon character quiz  
o. \`prank\` - Harmless prank idea
                `);
                break;

            case '2':
                await msg.reply(`
üìà *Productivity Tools*  
a. \`todo\` - Manage tasks  
b. \`reminder\` - Set a reminder  
c. \`note\` - Save a note  
d. \`clock\` - Show time & date  
e. \`timer\` - Start a timer  
f. \`stopwatch\` - Start a stopwatch  
g. \`calendar\` - Show calendar events  
h. \`goal\` - Set a goal  
i. \`habit\` - Track habits  
j. \`budget\` - Simple budget tracker  
k. \`poll\` - Create a poll  
l. \`meeting\` - Schedule meeting  
m. \`task-priority\` - Prioritize tasks  
n. \`word-count\` - Count words  
o. \`remind-me\` - Custom reminder
                `);
                break;

            case '3':
                await msg.reply(`
üë®‚Äçüíª *Developer Tools*  
a. \`format json\` - Auto-format JSON  
b. \`timestamp\` - Current UNIX time  
c. \`uuid\` - Generate UUID  
d. \`ip\` - Show local IP  
e. \`base64\` - Encode/decode Base64  
f. \`hash\` - Generate hash (MD5/SHA)  
g. \`url-encode\` - URL encode/decode  
h. \`regex-test\` - Test regex pattern  
i. \`http-status\` - HTTP status codes  
j. \`color-hex\` - Random color hex  
k. \`ascii\` - Text to ASCII art  
l. \`git-tip\` - Random Git tip  
m. \`npm-package\` - Search npm package  
n. \`jwt-decode\` - Decode JWT token  
o. \`lorem\` - Generate lorem ipsum
                `);
                break;

            case '4':
                await msg.reply(`
üìú *Quotes & Jokes*  
a. \`motivate\` - Motivational quote  
b. \`joke\` - Random joke  
c. \`proverb\` - Wise proverb  
d. \`roast me\` - Funny roast  
e. \`dad-joke\` - Classic dad joke  
f. \`inspire\` - Inspiring quote  
g. \`love-quote\` - Romantic quote  
h. \`funny-quote\` - Humorous quote  
i. \`life-advice\` - Life wisdom  
j. \`success-quote\` - Success quote  
k. \`pun\` - Wordplay pun  
l. \`yo-mama\` - Yo mama joke  
m. \`chuck-norris\` - Chuck Norris fact  
n. \`sarcasm\` - Sarcastic remark  
o. \`wisdom\` - Deep thought
                `);
                break;

            case '5':
                await msg.reply(`
ü§ñ *AI & Fun Stuff*  
a. \`8ball\` - Magic 8-ball  
b. \`fact\` - Fun fact  
c. \`emoji\` - Random emoji storm  
d. \`hack me\` - Simulated hack  
e. \`roll-dice\` - Roll a dice  
f. \`coin-flip\` - Flip a coin  
g. \`random-number\` - Random number  
h. \`password\` - Generate password  
i. \`pickup-line\` - Cheesy pickup line  
j. \`fortune\` - Fortune cookie  
k. \`animal-fact\` - Animal trivia  
l. \`space-fact\` - Space trivia  
m. \`meme-gen\` - Meme generator (text)  
n. \`dare\` - Fun dare  
o. \`truth\` - Truth question
                `);
                break;

            case '6':
                await msg.reply(`
‚öôÔ∏è *Settings*  
a. \`language\` - Change language  
b. \`theme\` - Dark/Light mode (concept)  
c. \`reset\` - Reset preferences  
d. \`feedback\` - Share thoughts  
e. \`timezone\` - Set timezone  
f. \`nickname\` - Set bot nickname  
g. \`notifications\` - Toggle notifications  
h. \`privacy\` - Privacy settings  
i. \`status\` - Bot status  
j. \`backup\` - Backup data (concept)
                `);
                break;

                case '7':
                    try {
                        console.log('About command triggered for:', chatId);
                        const imagePath = './assets/public.jpg';
                
                        if (!fs.existsSync(imagePath)) {
                            console.error('Image file not found at:', imagePath);
                            await msg.reply('‚ùå Error: Image file not found. Contact the developer!');
                            return;
                        }
                
                        const media = MessageMedia.fromFilePath(imagePath);
                
                        await client.sendMessage(chatId, media, {
                            caption: `
                ü§ñ *vBot AI Deluxe*  
                Made with ‚ù§Ô∏è by *Venom (Maseno Uni)* üêç  
                Powered by *spacyfire* ‚öôÔ∏è  
                Uptime: 24/7 (real soon!)  
                üíª Contact for any tech service!
                
                üîó *LinkedIn*: https://linkedin.com/in/owano-canol  
                üë®‚Äçüíª *GitHub*: https://github.com/Canol001  
                üåê *Portfolio*: https://canol.rollbackbets.top/
                            `.trim()
                        });
                
                    } catch (error) {
                        console.error('Error in About command:', error.message);
                        await msg.reply('‚ùå Error sending About info. Try again later!');
                    }
                    break;
                

            case '8':
                await msg.reply(`
üÜò *Help Center*  
a. \`.menu\` - Main menu  
b. \`suggest\` - Suggest a feature  
c. \`bug\` - Report a bug  
d. \`tutorial\` - Bot tutorial  
e. \`faq\` - Frequently asked questions
                `);
                break;

            case '9':
                await msg.reply(`
üé≤ *Games*  
a. \`rps\` - Rock, Paper, Scissors  
b. \`tic-tac-toe\` - Play Tic-Tac-Toe (concept)  
c. \`hangman\` - Hangman game  
d. \`number-guess\` - Guess the number  
e. \`word-scramble\` - Unscramble words  
f. \`math-quiz\` - Math challenge  
g. \`emoji-guess\` - Guess the emoji  
h. \`adventure\` - Text adventure  
i. \`puzzle\` - Simple puzzle  
j. \`battle\` - Fun text battle
                `);
                break;

            case '10':
                await msg.reply(`
üõ†Ô∏è *Utilities*  
a. \`weather\` - Check weather (via API)  
b. \`translate\` - Translate text  
c. \`calc\` - Simple calculator  
d. \`unit-convert\` - Convert units  
e. \`currency\` - Currency converter  
f. \`qr-gen\` - Generate QR code (text)  
g. \`shorten-url\` - Shorten URL (API)  
h. \`define\` - Dictionary lookup  
i. \`news\` - Latest news (API)  
j. \`stock\` - Stock price (API)  
k. \`password-strength\` - Check password  
l. \`timezone-convert\` - Convert timezones  
m. \`file-info\` - Analyze file (concept)  
n. \`random-name\` - Random name generator  
o. \`poll-result\` - View poll results
                `);
                break;
        }

        // === FEATURE COMMANDS ===
        switch (message) {
            case 'joke':
                await msg.reply('üòÇ Why don‚Äôt scientists trust atoms? Because they make up everything!');
                break;

            case 'fact':
                await msg.reply('üß† Did you know? Honey never spoils. Archeologists found 3000-year-old jars in Egyptian tombs still edible!');
                break;

            case '8ball':
                const responses = ['Yes.', 'No.', 'Maybe.', 'Absolutely!', 'Try again later.'];
                await msg.reply(`üé± ${responses[Math.floor(Math.random() * responses.length)]}`);
                break;

            case 'clock':
                const now = new Date();
                await msg.reply(`üïí Time: ${now.toLocaleTimeString()}\nüìÖ Date: ${now.toLocaleDateString()}`);
                break;

            case 'uuid':
                const { v4: uuidv4 } = require('uuid');
                await msg.reply(`üÜî UUID: ${uuidv4()}`);
                break;

            case 'roast me':
                await msg.reply('üî• You have something on your chin... no, the third one down.');
                break;

            case 'riddle':
                await msg.reply('üß© I speak without a mouth and hear without ears. I have no body, but I come alive with the wind. What am I? (Reply with answer!)');
                break;

            case 'trivia':
                await msg.reply('‚ùì Which planet is known as the Red Planet? (Reply: Mars)');
                break;

            case 'song':
                const songs = ['Bohemian Rhapsody', 'Shape of You', 'Blinding Lights'];
                await msg.reply(`üéµ Try this song: ${songs[Math.floor(Math.random() * songs.length)]}`);
                break;

            case 'movie':
                const movies = ['Inception', 'The Matrix', 'Parasite'];
                await msg.reply(`üé¨ Watch this movie: ${movies[Math.floor(Math.random() * movies.length)]}`);
                break;

            case 'dance':
                const dances = ['Moonwalk', 'Floss', 'Salsa'];
                await msg.reply(`üíÉ Try this dance move: ${dances[Math.floor(Math.random() * dances.length)]}`);
                break;

            case 'story':
                await msg.reply('üìñ Once upon a time, a curious coder discovered a hidden API... (Want more? Say "continue")');
                break;

            case 'emoji-story':
                await msg.reply('üò∫üåçüöÄ A cat took over the world with a rocket! Add your emoji to continue!');
                break;

            case 'magic-trick':
                await msg.reply('üé© Pick a number between 1-10, double it, subtract 2, and I‚Äôll guess it! (Reply with final number)');
                break;

            case 'superhero':
                await msg.reply('ü¶∏‚Äç‚ôÇÔ∏è Your superhero name: CodeBlaster! Power: Bug-zapping lasers! Want another?');
                break;

            case 'cartoon':
                await msg.reply('üì∫ Are you more SpongeBob or Rick Sanchez? Take my quiz! (Say "quiz")');
                break;

            case 'prank':
                await msg.reply('üòú Text your friend: "Your phone is updating to Comic Sans mode!"');
                break;

            case 'meme':
                await msg.reply('üòÇ Meme loading... Try: "Distracted Boyfriend" meme!');
                break;

            case 'game':
                await msg.reply('üéÆ Want a quick game? Try `rps` for Rock, Paper, Scissors!');
                break;

            case 'quiz':
                await msg.reply('‚ùì Quiz time! What‚Äôs 2+2? Reply: 4 (More? Say "next")');
                break;

            case 'timer':
                await msg.reply('‚è≤Ô∏è Timer started for 5 minutes! I‚Äôll ping you when done. (Custom time? Say "timer 10m")');
                break;

            case 'stopwatch':
                await msg.reply('‚è±Ô∏è Stopwatch started! Say "stop" to end.');
                break;

            case 'calendar':
                await msg.reply('üìÜ Today‚Äôs date: April 15, 2025. Want events? Say "add event"!');
                break;

            case 'goal':
                await msg.reply('üéØ Set a goal: "Finish project by Friday." Saved! Check? Say "list goals".');
                break;

            case 'habit':
                await msg.reply('‚úÖ Track habit: "Drink water daily." Added! View? Say "list habits".');
                break;

            case 'budget':
                await msg.reply('üí∏ Budget tracker: Add expense with "add expense 10 coffee". Try it!');
                break;

            case 'poll':
                await msg.reply('üìä Create poll: "Pizza or Burger?" Reply with votes!');
                break;

            case 'meeting':
                await msg.reply('üìÖ Schedule meeting: Say "meet at 3pm tomorrow". Saved!');
                break;

            case 'task-priority':
                await msg.reply('üìã Prioritize: Send tasks like "1. Code, 2. Debug". I‚Äôll sort!');
                break;

            case 'word-count':
                await msg.reply('üìù Send a sentence, I‚Äôll count words! Try: "I love coding"');
                break;

            case 'remind-me':
                await msg.reply('‚è∞ Set reminder: Say "remind me call mom at 5pm". Got it!');
                break;

            case 'todo':
                await msg.reply('‚úÖ Add task: Say "todo finish homework". List? Say "list todo".');
                break;

            case 'reminder':
                await msg.reply('üîî Reminder set: Say "reminder meeting 10am". I‚Äôll notify!');
                break;

            case 'note':
                await msg.reply('üìù Save note: Say "note buy milk". View? Say "list notes".');
                break;

            case 'base64':
                await msg.reply('üî¢ Send text to encode/decode in Base64! Try: "base64 hello"');
                break;

            case 'hash':
                const crypto = require('crypto');
                await msg.reply(`üîí MD5 hash of "test": ${crypto.createHash('md5').update('test').digest('hex')}`);
                break;

            case 'url-encode':
                await msg.reply('üåê Send text to URL encode! Try: "url-encode hello world"');
                break;

            case 'regex-test':
                await msg.reply('üîç Test regex: Send "regex /d+/ 123". I‚Äôll check!');
                break;

            case 'http-status':
                await msg.reply('üåê HTTP 200: OK. Want another? Say "http 404"');
                break;

            case 'color-hex':
                const hex = Math.floor(Math.random() * 16777215).toString(16);
                await msg.reply(`üé® Random color: #${hex}`);
                break;

            case 'ascii':
                await msg.reply('üñºÔ∏è ASCII art: Send "ascii star" for a star!');
                break;

            case 'git-tip':
                await msg.reply('üîß Git tip: Use `git stash` to save changes temporarily.');
                break;

            case 'npm-package':
                await msg.reply('üì¶ Search npm: Say "npm express" for package info.');
                break;

            case 'jwt-decode':
                await msg.reply('üîê Send JWT token to decode! Try: "jwt <token>"');
                break;

            case 'lorem':
                await msg.reply('üìú Lorem ipsum: Lorem ipsum dolor sit amet... More? Say "lorem 10"');
                break;

            case 'format json':
                await msg.reply('üßπ Send JSON to format! Try: `{"name":"John"}`');
                break;

            case 'timestamp':
                await msg.reply(`‚è∞ UNIX timestamp: ${Math.floor(Date.now() / 1000)}`);
                break;

            case 'ip':
                await msg.reply('üåê Local IP: 127.0.0.1 (Public IP? Use API!)');
                break;

            case 'dad-joke':
                await msg.reply('üòÜ Why can‚Äôt basketball players go on vacation? They‚Äôd get called for traveling!');
                break;

            case 'inspire':
                await msg.reply('üåü "The only limit to our realization of tomorrow is our doubts of today." ‚Äì FDR');
                break;

            case 'love-quote':
                await msg.reply('üíñ "Love is not finding someone to live with; it‚Äôs finding someone you can‚Äôt live without."');
                break;

            case 'funny-quote':
                await msg.reply('üòÇ "I‚Äôm not lazy, I‚Äôm on energy-saving mode."');
                break;

            case 'life-advice':
                await msg.reply('üßò "Take one step at a time; every step counts."');
                break;

            case 'success-quote':
                await msg.reply('üèÜ "Success is not the absence of obstacles, but the courage to push through."');
                break;

            case 'pun':
                await msg.reply('üòú I‚Äôm reading a book on anti-gravity. It‚Äôs impossible to put down!');
                break;

            case 'yo-mama':
                await msg.reply('ü§™ Yo mama so fat that she needs cheat codes for Wii Fit.');
                break;

            case 'chuck-norris':
                await msg.reply('üí™ Chuck Norris can divide by zero.');
                break;

            case 'sarcasm':
                await msg.reply('üôÑ Oh, brilliant idea! Why didn‚Äôt I think of that?');
                break;

            case 'wisdom':
                await msg.reply('ü¶â "The only true wisdom is knowing you know nothing." ‚Äì Socrates');
                break;

            case 'motivate':
                await msg.reply('üöÄ "You‚Äôre one step away from greatness. Keep going!"');
                break;

            case 'proverb':
                await msg.reply('üìú "A journey of a thousand miles begins with a single step."');
                break;

            case 'roll-dice':
                await msg.reply(`üé≤ You rolled: ${Math.floor(Math.random() * 6) + 1}`);
                break;

            case 'coin-flip':
                await msg.reply(`ü™ô Result: ${Math.random() > 0.5 ? 'Heads' : 'Tails'}`);
                break;

            case 'random-number':
                await msg.reply(`üî¢ Random number: ${Math.floor(Math.random() * 100)}`);
                break;

            case 'password':
                const pass = Math.random().toString(36).slice(-8);
                await msg.reply(`üîê Password: ${pass}`);
                break;

            case 'pickup-line':
                await msg.reply('üòò Is your name Wi-Fi? Because I‚Äôm feeling a connection!');
                break;

            case 'fortune':
                await msg.reply('üç™ Fortune: "A great adventure awaits you."');
                break;

            case 'animal-fact':
                await msg.reply('üêò Elephants never forget, and they can recognize themselves in mirrors!');
                break;

            case 'space-fact':
                await msg.reply('üåå There are more stars in the universe than grains of sand on Earth.');
                break;

            case 'meme-gen':
                await msg.reply('üñºÔ∏è Meme text: Send "meme-gen Top text | Bottom text"');
                break;

            case 'dare':
                await msg.reply('üòà Dare: Text a friend "I know your secret!"');
                break;

            case 'truth':
                await msg.reply('ü§´ Truth: What‚Äôs the weirdest food combo you‚Äôve tried?');
                break;

            case 'emoji':
                const emojis = ['üò∫', 'üöÄ', 'üåÆ'];
                await msg.reply(`üéâ ${emojis[Math.floor(Math.random() * emojis.length)]} ${emojis[Math.floor(Math.random() * emojis.length)]}`);
                break;

            case 'hack me':
                await msg.reply('üíæ *HACKING...* Just kidding! Your data‚Äôs safe. üòú Want a real hack tip?');
                break;

            case 'timezone':
                await msg.reply('üåê Set timezone: Say "timezone UTC+1". Default: UTC');
                break;

            case 'nickname':
                await msg.reply('üòé Set bot nickname: Say "nickname CoolBot". Done!');
                break;

            case 'notifications':
                await msg.reply('üîî Toggle notifications: Say "notifications off". Current: On');
                break;

            case 'privacy':
                await msg.reply('üîí Privacy: Your data stays with me. Want details? Say "privacy info"');
                break;

            case 'status':
                await msg.reply('üì° Bot status: Online, 100+ features, vibing! üöÄ');
                break;

            case 'backup':
                await msg.reply('üíæ Backup: Data saved (concept). Want to restore? Say "restore"');
                break;

            case 'language':
                await msg.reply('üåç Set language: Say "language Spanish". Default: English');
                break;

            case 'theme':
                await msg.reply('üé® Set theme: Say "theme dark". Current: Light');
                break;

            case 'reset':
                await msg.reply('üßπ Preferences reset! Start fresh with `.menu`');
                break;

            case 'feedback':
                await msg.reply('üì¨ Share feedback: Say "feedback Love the bot!" I‚Äôm listening!');
                break;

            case 'suggest':
                await msg.reply('üí° Suggest a feature: Say "suggest voice chat". Thanks!');
                break;

            case 'bug':
                await msg.reply('üêõ Report bug: Say "bug quiz crashes". I‚Äôll check!');
                break;

            case 'tutorial':
                await msg.reply('üìö Tutorial: Start with `.menu`, try `joke`, or say `hi`! More?');
                break;

            case 'faq':
                await msg.reply('‚ùì FAQ: "How to use bot?" Just type `.menu`! Ask more!');
                break;

            case 'rps':
                const choices = ['rock', 'paper', 'scissors'];
                const botChoice = choices[Math.floor(Math.random() * 3)];
                await msg.reply(`‚úä My choice: ${botChoice}. Send yours (rock/paper/scissors)!`);
                break;

            case 'tic-tac-toe':
                await msg.reply('‚≠ï‚ùå Tic-Tac-Toe: Send "ttt start" to play (concept)!');
                break;

            case 'hangman':
                await msg.reply('ü™¢ Hangman: Guess the word: _ _ _ _. Send a letter!');
                break;

            case 'number-guess':
                await msg.reply('üî¢ Guess my number (1-10)! Send your guess.');
                break;

            case 'word-scramble':
                await msg.reply('üî§ Unscramble: "olhel". Hint: Greeting. Reply with answer!');
                break;

            case 'math-quiz':
                await msg.reply('üßÆ What‚Äôs 5 √ó 4? Reply with answer!');
                break;

            case 'emoji-guess':
                await msg.reply('üòÄ Guess the emoji: üò∫ means? Reply: Cat');
                break;

            case 'adventure':
                await msg.reply('üó∫Ô∏è You‚Äôre in a forest. Go "left" or "right"?');
                break;

            case 'puzzle':
                await msg.reply('üß© Puzzle: Move 1 matchstick to fix 2+2=22. Reply with solution!');
                break;

            case 'battle':
                await msg.reply('‚öîÔ∏è You vs. Dragon! Attack with "slash" or "run"!');
                break;

            case 'weather':
                await msg.reply('‚òÄÔ∏è Weather: Say "weather Nairobi" for forecast!');
                break;

            case 'translate':
                await msg.reply('üåç Translate: Say "translate hello to Spanish". Result: Hola');
                break;

            case 'calc':
                await msg.reply('üßÆ Calculate: Say "calc 5 + 3". Result: 8');
                break;

            case 'unit-convert':
                await msg.reply('üìè Convert: Say "convert 10 km to miles". Result: 6.21 miles');
                break;

            case 'currency':
                await msg.reply('üíµ Convert: Say "currency 10 USD to EUR". Try it!');
                break;

            case 'qr-gen':
                await msg.reply('üì∑ QR code: Say "qr-gen https://example.com" for QR text!');
                break;

            case 'shorten-url':
                await msg.reply('üîó Shorten: Say "shorten https://example.com". Coming soon!');
                break;

            case 'define':
                await msg.reply('üìñ Define: Say "define happy". Meaning: Feeling joy!');
                break;

            case 'news':
                await msg.reply('üì∞ News: Say "news tech" for headlines!');
                break;

            case 'stock':
                await msg.reply('üìà Stock: Say "stock AAPL" for price!');
                break;

            case 'password-strength':
                await msg.reply('üîí Check password: Say "password-strength 123". Weak!');
                break;

            case 'timezone-convert':
                await msg.reply('‚è∞ Convert time: Say "timezone-convert 3pm UTC to EST". Result: 11am');
                break;

            case 'file-info':
                await msg.reply('üìÇ File info: Send file details (concept). Try: "file-info doc.pdf"');
                break;

            case 'random-name':
                const names = ['Alex', 'Sam', 'Taylor'];
                await msg.reply(`üßë Random name: ${names[Math.floor(Math.random() * names.length)]}`);
                break;

            case 'poll-result':
                await msg.reply('üìä Poll results: No active polls. Start one with `poll`!');
                break;

            default:
                if (
                    ![
                        'hi', 'hello', '.menu', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
                        'joke', 'fact', '8ball', 'clock', 'uuid', 'roast me', 'riddle', 'trivia', 'song', 'movie',
                        'dance', 'story', 'emoji-story', 'magic-trick', 'superhero', 'cartoon', 'prank', 'meme', 'game',
                        'quiz', 'timer', 'stopwatch', 'calendar', 'goal', 'habit', 'budget', 'poll', 'meeting',
                        'task-priority', 'word-count', 'remind-me', 'todo', 'reminder', 'note', 'base64', 'hash',
                        'url-encode', 'regex-test', 'http-status', 'color-hex', 'ascii', 'git-tip', 'npm-package',
                        'jwt-decode', 'lorem', 'format json', 'timestamp', 'ip', 'dad-joke', 'inspire', 'love-quote',
                        'funny-quote', 'life-advice', 'success-quote', 'pun', 'yo-mama', 'chuck-norris', 'sarcasm',
                        'wisdom', 'motivate', 'proverb', 'roll-dice', 'coin-flip', 'random-number', 'password',
                        'pickup-line', 'fortune', 'animal-fact', 'space-fact', 'meme-gen', 'dare', 'truth', 'emoji',
                        'hack me', 'timezone', 'nickname', 'notifications', 'privacy', 'status', 'backup', 'language',
                        'theme', 'reset', 'feedback', 'suggest', 'bug', 'tutorial', 'faq', 'rps', 'tic-tac-toe',
                        'hangman', 'number-guess', 'word-scramble', 'math-quiz', 'emoji-guess', 'adventure', 'puzzle',
                        'battle', 'weather', 'translate', 'calc', 'unit-convert', 'currency', 'qr-gen', 'shorten-url',
                        'define', 'news', 'stock', 'password-strength', 'timezone-convert', 'file-info', 'random-name',
                        'poll-result'
                    ].includes(message)
                ) {
                    try {
                        const imagePath = './assets/intro.jpg'; // Use a cool fallback image here
                        if (!fs.existsSync(imagePath)) {
                            await client.sendMessage(chatId, `
                    ü§î *I didn't catch that!*  
                    Type \`.menu\` to explore
                    Here are some commands you can try:
                    
                    üìú \`.about\` - Bot info & credits  
                    üõ†Ô∏è \`.menu\` - List of all features  
                    üéÆ \`.fun\` - Jokes, games & more  
                    üìö \`.ai\` - Chat with AI (OpenAI)  
                    üí∞ \`.mpesa\` - M-PESA integration  
                    üé® \`.style\` - Name styling & fonts  
                    üåç \`.web\` - Browse links, news, etc.  
                    üìÖ \`.time\` - Date/time utilities  
                    üìä \`.stats\` - Bot stats & usage
                    
                    Still lost? Try typing \`hi\` or \`.help\` üôå
                            `, { quotedMessageId: null });
                        } else {
                            const media = MessageMedia.fromFilePath(imagePath);
                            await client.sendMessage(chatId, media, {
                                caption: `ü§ñ *VenomV_19*  
                    ü§î *I didn't catch that!*  
                    Type \`.menu\` to explore 
                    
                    üîß *Popular Commands*:
                    üìú \`.about\` - Bot info  
                    üõ†Ô∏è \`.menu\` - All features  
                    üí° \`.ai\` - Ask AI anything  
                    üìö \`.help\` - Help guide  
                    üíµ \`.mpesa\` - Payment features  
                    üéâ \`.fun\` - Mini games  
                    üß™ \`.labs\` - Experimental stuff  
                    
                    üìç Try something cool!
                                `,
                                quotedMessageId: null
                            });
                        }
                    
                        console.log(`Sent default response to ${chatId} for message: ${message}`);
                    } catch (replyError) {
                        console.error('Error sending default response:', replyError.message);
                    }
                }
                break;
        }
    } catch (error) {
        console.error('Error processing message:', error.message);
        try {
            await client.sendMessage(chatId, '‚ùå Something went wrong! Try again or contact the developer.', { quotedMessageId: null });
        } catch (replyError) {
            console.error('Failed to send error reply:', replyError.message);
        }
    }
});

client.initialize();